<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
  <meta name="viewport"
     content="width=device-width">
  
  <!-- Normalize V8.0.1 -->


  <!-- MDBootstrap V5 -->
  <link rel="stylesheet" href="./css/mdb.min.css">

  <!-- Font Awesome V5.15.1 -->
  <link rel="stylesheet" href="./css/all.css">

  <!-- Sweet Alert V10.13.0 -->


  <!-- General Styles -->
  <link rel="stylesheet" href="./css/style.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

  <title>Administrador Encargados de Almacén</title>
  <script type="module"
     src="./lib/js/custom/indicador-cargando.js">
     </script>
   <script type="module"
     src="./js/custom/mi-nav.js">
     </script>
</head>
<body>
    <header >
      <mi-nav id="nav"></mi-nav>
    </header>
    <main class="table">
        <section class="table__header">
            <h1>Encargados de Almacén</h1>
        </section>
        <section class="table__body">
            <table>
                <thead>
                  <tr> 
                     <a class="greens-button" 
                   href=".html"> + Añadir Encargado</a>
                    </
                  </tr>
                    <tr>
                        <th>id</th>
                        <th>Imagen</th>
                        <th>Nombre</th>
                        <th>Almacén Asignado</th>
                        <th>Modificar</th> 
                        <th>Eliminar</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td><img src="images/personal/per1.jpeg" alt=""></td>
                        <td>Canelo Saul</td>
                        <td>Almacen 1</td>
                        <td><button type="button" class="btn btn-outline-warning"><i class="bi bi-pencil"></i></button></td>
                        <td><button type="button" class="btn btn-outline-danger"><i class="bi bi-trash3"></i></button></td>
                        
                    </tr>
                    <tr>
                        <td>2</td>
                        <td><img src="images/personal/per2.jpeg" alt=""></td>
                        <td>Jackson Michael</td>
                        <td>Almacen 2</td>
                        <td><button type="button" class="btn btn-outline-warning"><i class="bi bi-pencil"></i></button></td>
                        <td><button type="button" class="btn btn-outline-danger"><i class="bi bi-trash3"></i></button></td>

                    </tr>
                  <tr>
                      <td>3</td>
                      <td><img src="images/personal/per3.jpeg" alt=""></td>
                      <td>Perez Checo</td>
                      <td>Almacen 3</td>
                      <td><button type="button" class="btn btn-outline-warning"><i class="bi bi-pencil"></i></button></td>
                      <td><button type="button" class="btn btn-outline-danger"><i class="bi bi-trash3"></i></button></td>

                  </tr>
                        
                    </tr>
                </tbody>
            </table>
        </section>
    </main>
  <script type="module">
    import {
     ejecuta
    } from "./lib/js/ejecuta.js"
    import {
     muestraError
    } from "./lib/js/muestraError.js"
    import {
     Sesion
    } from "./js/Sesion.js"

    preparaVista()

    async function preparaVista() {
     try {
      const json =
       await buscaEnElServidor()
      const sesion = new Sesion(json)
      muestra(sesion)
     } catch (e) {
      muestraError(e)
     }
    }

    async function
     buscaEnElServidor() {
     return await ejecuta(fetch(
      "srv/SrvSesion.php"))
    }

    function muestra(sesion) {
     const cue = sesion.cue
     const rolIds = sesion.rolIds
     nav.sesion = sesion
     roles.value = rolIds.size === 0
      ? "Sin roles"
      : Array.from(rolIds).join(", ")
     if (cue === "") {
      login.hidden = false
      usuario.value =
       "No ha iniciado sesión"
     } else {
      logout.hidden = false
      usuario.value = cue
      escuchaEventos()
     }
    }

    function escuchaEventos() {
     logout.addEventListener("click",
      terminaSesion)
    }

    async function terminaSesion() {
     try {
      await ejecuta(fetch(
       "srv/SrvLogout.php"))
      location.reload()
     } catch (e) {
      muestraError(e)
     }
    }
   </script>

  <!-- MDBootstrap V5 -->
  <script src="./js/mdb.min.js" ></script>

  <!-- General scripts -->
  <script src="./js/main.js" ></script>
  <script src="../lib/js/nav.js" ></script>
</body>
</html>